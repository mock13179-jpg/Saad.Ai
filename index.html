<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ø³Ø¹Ø¯.AI - Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ Ø§Ù„Ù…ØªØ·ÙˆØ±</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <!-- Ø¥Ø²Ø§Ù„Ø© Ù…ÙƒØªØ¨Ø© Google Sign-In -->
  <style>
    /* Ø£Ù†Ù…Ø§Ø· Ø¹Ø§Ù„Ù…ÙŠØ© Ø¨ØªØµÙ…ÙŠÙ… ÙØ§Ø®Ø± Ø¨Ø§Ù„Ø£Ø³ÙˆØ¯ */
    :root {
      --primary-black: #000000;
      --dark-charcoal: #121212;
      --graphite: #1a1a1a;
      --carbon: #222222;
      --light-charcoal: #2d2d2d;
      --platinum: #e0e0e0;
      --silver: #f0f0f0;
      --neon-blue: #4895ef;
      --electric-purple: #a855f7;
      --font-primary: 'Tajawal', 'Segoe UI', sans-serif;
      --gold-accent: #ffd700;
      
      /* Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ø³Ù…Ø§Øª */
      --theme-primary: #4895ef;
      --theme-secondary: #a855f7;
      --theme-background: #121212;
      --theme-surface: #1a1a1a;
      --theme-text: #f0f0f0;
      --theme-text-secondary: #e0e0e0;
    }

    /* Ø³Ù…Ø© ÙØ§ØªØ­Ø© */
    .theme-light {
      --primary-black: #ffffff;
      --dark-charcoal: #f5f5f5;
      --graphite: #e8e8e8;
      --carbon: #e0e0e0;
      --light-charcoal: #d5d5d5;
      --platinum: #333333;
      --silver: #222222;
      --neon-blue: #1a73e8;
      --electric-purple: #6200ee;
      --theme-primary: #1a73e8;
      --theme-secondary: #6200ee;
      --theme-background: #ffffff;
      --theme-surface: #f5f5f5;
      --theme-text: #222222;
      --theme-text-secondary: #333333;
    }

    /* Ø³Ù…Ø© Ø²Ø±Ù‚Ø§Ø¡ */
    .theme-blue {
      --primary-black: #0a192f;
      --dark-charcoal: #112240;
      --graphite: #1d3a5f;
      --carbon: #264b7a;
      --light-charcoal: #2d5c94;
      --platinum: #ccd6f6;
      --silver: #a8b2d1;
      --neon-blue: #64ffda;
      --electric-purple: #57cbff;
      --theme-primary: #64ffda;
      --theme-secondary: #57cbff;
      --theme-background: #0a192f;
      --theme-surface: #112240;
      --theme-text: #ccd6f6;
      --theme-text-secondary: #a8b2d1;
    }

    /* Ø³Ù…Ø© Ø®Ø¶Ø±Ø§Ø¡ */
    .theme-green {
      --primary-black: #0d2618;
      --dark-charcoal: #1a3c27;
      --graphite: #275236;
      --carbon: #346845;
      --light-charcoal: #417e54;
      --platinum: #d4e6d9;
      --silver: #a8c5b1;
      --neon-blue: #4caf50;
      --electric-purple: #8bc34a;
      --theme-primary: #4caf50;
      --theme-secondary: #8bc34a;
      --theme-background: #0d2618;
      --theme-surface: #1a3c27;
      --theme-text: #d4e6d9;
      --theme-text-secondary: #a8c5b1;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      transition: all 0.3s ease;
    }

    body {
      font-family: var(--font-primary);
      background: linear-gradient(135deg, var(--theme-background) 0%, var(--dark-charcoal) 100%);
      color: var(--theme-text);
      line-height: 1.8;
      min-height: 100vh;
      overflow-x: hidden;
      position: relative;
    }

    body::before {
      content: "";
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: 
        radial-gradient(circle at 10% 20%, rgba(var(--theme-primary-rgb), 0.05) 0%, transparent 20%),
        radial-gradient(circle at 90% 80%, rgba(var(--theme-secondary-rgb), 0.05) 0%, transparent 20%);
      pointer-events: none;
      z-index: -1;
    }

    /* ØªØµÙ…ÙŠÙ… Ù…ØªØ·ÙˆØ± Ù„Ù„Ø­Ø§ÙˆÙŠØ© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© */
    .app-container {
      display: flex;
      flex-direction: column;
      min-height: 100vh;
      max-width: 1400px;
      margin: 0 auto;
      background: rgba(var(--theme-surface-rgb), 0.9);
      box-shadow: 
        0 0 50px rgba(0, 0, 0, 0.8),
        0 0 100px rgba(var(--theme-primary-rgb), 0.1);
      border-left: 1px solid rgba(var(--theme-primary-rgb), 0.1);
      border-right: 1px solid rgba(var(--theme-primary-rgb), 0.1);
      position: relative;
      overflow: hidden;
    }

    /* Ø´Ø±ÙŠØ· Ø§Ù„Ø¹Ù†ÙˆØ§Ù† Ø§Ù„ÙØ§Ø®Ø± */
    .app-header {
      background: linear-gradient(90deg, var(--primary-black) 0%, var(--graphite) 100%);
      color: var(--theme-text);
      padding: 1.5rem 3rem;
      text-align: center;
      border-bottom: 3px solid var(--theme-primary);
      position: relative;
      overflow: hidden;
      z-index: 2;
      display: flex;
      align-items: center;
      justify-content: space-between;
      flex-wrap: wrap;
    }

    .app-header::before {
      content: "";
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 3px;
      background: linear-gradient(90deg, var(--theme-primary), var(--theme-secondary));
      animation: headerGlow 3s infinite alternate;
    }

    @keyframes headerGlow {
      0% { opacity: 0.3; }
      100% { opacity: 1; }
    }

    /* ØªØµÙ…ÙŠÙ… Ø§Ù„Ø´Ø¹Ø§Ø± */
    .logo-main {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 15px;
      position: relative;
      z-index: 3;
      flex: 1;
    }

    .header-controls {
      display: flex;
      gap: 15px;
      align-items: center;
    }

    .header-btn {
      background: none;
      border: none;
      color: var(--theme-text-secondary);
      font-size: 1.5rem;
      cursor: pointer;
      padding: 10px;
      border-radius: 8px;
      transition: all 0.3s ease;
    }

    .header-btn:hover {
      background: rgba(var(--theme-primary-rgb), 0.2);
      transform: scale(1.1);
    }

    /* Ø²Ø± ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ - ØªÙ… Ø§Ù„ØªØ¹Ø¯ÙŠÙ„ Ù„Ø¥Ø²Ø§Ù„Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ */
    .login-btn {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 1rem;
      padding: 8px 16px;
      background: rgba(var(--theme-primary-rgb), 0.1);
      border: 1px solid rgba(var(--theme-primary-rgb), 0.3);
      border-radius: 20px;
      color: var(--theme-text);
    }

    .login-btn:hover {
      background: rgba(var(--theme-primary-rgb), 0.3);
    }

    .main-logo {
      width: 140px;
      height: 140px;
      object-fit: contain;
      border-radius: 50%;
      background: linear-gradient(145deg, var(--graphite), var(--primary-black));
      padding: 15px;
      box-shadow: 
        0 0 20px rgba(var(--theme-primary-rgb), 0.3),
        0 0 40px rgba(var(--theme-primary-rgb), 0.1);
      border: 2px solid var(--theme-primary);
      transition: transform 0.5s ease;
    }

    .main-logo:hover {
      transform: rotate(10deg) scale(1.05);
    }

    .logo-main h1 {
      font-size: 3rem;
      font-weight: 800;
      background: linear-gradient(90deg, var(--theme-primary), var(--theme-secondary));
      -webkit-background-clip: text;
      background-clip: text;
      -webkit-text-fill-color: transparent;
      text-shadow: 0 0 20px rgba(var(--theme-primary-rgb), 0.5);
      letter-spacing: 1px;
    }

    .subtitle {
      font-size: 1.2rem;
      opacity: 0.9;
      margin-top: 0.5rem;
      color: var(--theme-text-secondary);
      max-width: 600px;
      margin: 10px auto;
      line-height: 1.6;
      flex-basis: 100%;
    }

    /* Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ø¯Ø±Ø¯Ø´Ø© Ø§Ù„Ù…ØªØ·ÙˆØ±Ø© */
    .chat-container {
      display: flex;
      flex-direction: column;
      flex: 1;
      padding: 2rem;
      background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100"><rect width="100" height="100" fill="none" stroke="rgba(var(--theme-primary-rgb), 0.1)" stroke-width="0.5"/></svg>');
      background-size: 30px 30px;
      position: relative;
    }

    .chat-history {
      flex: 1;
      overflow-y: auto;
      padding: 1.5rem;
      margin-bottom: 1.5rem;
      border-radius: 16px;
      background: rgba(var(--theme-surface-rgb), 0.7);
      border: 1px solid rgba(var(--theme-primary-rgb), 0.2);
      box-shadow: inset 0 0 20px rgba(0, 0, 0, 0.5);
      backdrop-filter: blur(10px);
      display: flex;
      flex-direction: column;
      gap: 12px; /* ØªÙ‚Ù„ÙŠÙ„ Ø§Ù„Ù…Ø³Ø§ÙØ© Ø¨ÙŠÙ† Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ */
    }

    .welcome-message {
      text-align: center;
      padding: 1.5rem;
      color: var(--theme-primary);
      font-weight: 600;
      font-size: 1.3rem;
      background: rgba(var(--theme-surface-rgb), 0.6);
      border-radius: 12px;
      border: 1px solid rgba(var(--theme-primary-rgb), 0.3);
      margin-bottom: 20px;
    }

    /* Ø±Ø³Ø§Ø¦Ù„ Ø­Ø¯ÙŠØ«Ø© Ø¨ØªØµÙ…ÙŠÙ… Ø¹ØµØ±ÙŠ */
    .message {
      margin-bottom: 0.5rem;
      padding: 0.8rem; /* ØªÙ‚Ù„ÙŠÙ„ Ø§Ù„Ø­Ø´Ùˆ Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠ */
      border-radius: 18px;
      max-width: 85%;
      position: relative;
      animation: fadeIn 0.4s ease;
      line-height: 1.7;
      font-size: 1.1rem;
      word-break: break-word;
      overflow-wrap: break-word;
      white-space: pre-wrap;
      word-wrap: break-word;
      overflow: hidden;
      border: none !important;
      min-width: 120px;
      box-sizing: border-box;
      background: rgba(255, 255, 255, 0.03) !important; /* Ø®Ù„ÙÙŠØ© Ù…ÙˆØ­Ø¯Ø© Ø®ÙÙŠÙØ© */
      box-shadow: none !important;
      backdrop-filter: none !important;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .user-message {
      background: rgba(255, 255, 255, 0.04) !important; /* ÙØ±Ù‚ Ø·ÙÙŠÙ Ù„Ù„ØªÙ…ÙŠÙŠØ² */
      color: var(--theme-text);
      margin-left: auto;
      margin-right: 0;
      max-width: 90%;
      width: fit-content;
      padding-left: 1.8rem;
      padding-right: 1.2rem;
      border-radius: 18px 5px 18px 18px;
    }

    .bot-message {
      background: rgba(255, 255, 255, 0.03) !important; /* Ù†ÙØ³ Ù„ÙˆÙ† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ØªÙ‚Ø±ÙŠØ¨Ø§Ù‹ */
      color: var(--theme-text-secondary);
      margin-right: auto;
      margin-left: 0;
      max-width: 90%;
      width: fit-content;
      padding-right: 1.8rem;
      padding-left: 1.2rem;
      border-radius: 5px 18px 18px 18px;
    }

    .message p {
      margin-bottom: 10px;
      word-break: break-word;
      overflow-wrap: anywhere;
      hyphens: auto;
      text-align: right;
      padding: 6px 10px; /* ØªÙ‚Ù„ÙŠÙ„ padding Ù„Ù„Ù†Øµ */
      margin: 0; /* Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ù‡ÙˆØ§Ù…Ø´ */
    }

    .message-time {
      font-size: 0.8rem;
      opacity: 0.7;
      display: block;
      margin-top: 0.8rem;
      color: var(--theme-text-secondary);
      text-align: left;
      padding: 0 10px; /* Ø¥Ø¶Ø§ÙØ© padding Ù„Ù„ÙˆÙ‚Øª */
    }

    /* Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ - ØªØµÙ…ÙŠÙ… Ø¬Ø¯ÙŠØ¯ */
    .message-actions {
      display: flex;
      justify-content: flex-start;
      gap: 8px;
      margin-top: 15px;
      padding-top: 10px;
      border-top: 1px solid rgba(255, 255, 255, 0.1);
      overflow-x: auto; /* Ù„Ù„ØªÙ…Ø±ÙŠØ± Ø§Ù„Ø£ÙÙ‚ÙŠ Ø¹Ù„Ù‰ Ø§Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„ØµØºÙŠØ±Ø© */
      padding-bottom: 5px;
      min-height: 44px; /* Ø§Ø±ØªÙØ§Ø¹ Ù…Ù†Ø§Ø³Ø¨ Ù„Ù„Ù…Ø³ */
    }

    .message-actions::-webkit-scrollbar {
      height: 4px;
    }

    .message-actions::-webkit-scrollbar-track {
      background: rgba(255, 255, 255, 0.1);
      border-radius: 2px;
    }

    .message-actions::-webkit-scrollbar-thumb {
      background: rgba(var(--theme-primary-rgb), 0.5);
      border-radius: 2px;
    }

    .message-btn {
      background: transparent !important; /* Ø®Ù„ÙÙŠØ© Ø´ÙØ§ÙØ© */
      border: none !important;
      color: var(--theme-text-secondary) !important;
      width: 44px !important; /* Ø­Ø¬Ù… Ù…Ù†Ø§Ø³Ø¨ Ù„Ù„Ù…Ø³ */
      height: 44px !important;
      border-radius: 6px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      font-size: 16px !important; /* Ø­Ø¬Ù… Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª Ø£ÙƒØ¨Ø± */
      transition: all 0.2s ease;
      padding: 6px !important; /* padding Ø¯Ø§Ø®Ù„ÙŠ ØµØºÙŠØ± */
      min-width: 44px !important; /* Ø¹Ø±Ø¶ Ø£Ø¯Ù†Ù‰ */
    }

    .message-btn:hover {
      background: rgba(255, 255, 255, 0.1) !important; /* ØªØ£Ø«ÙŠØ± hover Ø®ÙÙŠÙ */
      transform: scale(1.05);
    }

    .message-btn.active-like {
      color: #4CAF50 !important;
      background: rgba(76, 175, 80, 0.1) !important;
    }

    .message-btn.active-dislike {
      color: #f44336 !important;
      background: rgba(244, 67, 54, 0.1) !important;
    }

    /* Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ Ø¨ØªØµÙ…ÙŠÙ… ÙØ§Ø®Ø± */
    .input-area {
      display: flex;
      flex-direction: column;
      gap: 1.2rem;
      position: relative; /* Ù„Ù„Ø³Ù…Ø§Ø­ Ø¨ÙˆØ¶Ø¹ Ø²Ø± Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ù…Ø·Ù„Ù‚ */
    }

    textarea {
      width: 100%;
      padding: 1.2rem 5rem 1.2rem 5.5rem; /* Ø²ÙŠØ§Ø¯Ø© Ø§Ù„Ù…Ø³Ø§Ø­Ø© Ø¹Ù„Ù‰ Ø§Ù„ÙŠÙ…ÙŠÙ† Ù„Ø²Ø± Ø§Ù„Ù…Ø±ÙÙ‚ */
      border: 2px solid rgba(var(--theme-primary-rgb), 0.3);
      border-radius: 14px;
      resize: none;
      font-family: var(--font-primary);
      font-size: 1.1rem;
      background: rgba(var(--theme-surface-rgb), 0.7);
      color: var(--theme-text);
      backdrop-filter: blur(5px);
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
      min-height: 120px;
    }

    textarea:focus {
      outline: none;
      border-color: var(--theme-primary);
      box-shadow: 0 0 0 3px rgba(var(--theme-primary-rgb), 0.3), 0 0 20px rgba(var(--theme-primary-rgb), 0.2);
    }

    textarea::placeholder {
      color: #777;
    }

    /* Ø²Ø± Ø§Ù„Ù…Ø±ÙÙ‚ Ø§Ù„Ø¬Ø¯ÙŠØ¯ */
    .attach-fab {
      position: absolute;
      left: 75px; /* ÙˆØ¶Ø¹ Ø¹Ù„Ù‰ ÙŠØ³Ø§Ø± Ø²Ø± Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ */
      bottom: 12px;
      width: 56px;
      height: 56px;
      border-radius: 50%;
      border: none;
      background: linear-gradient(135deg, var(--light-charcoal) 0%, var(--carbon) 100%);
      color: var(--theme-text);
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.5rem;
      transition: all 0.3s ease;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
      z-index: 10;
    }

    .attach-fab:hover {
      transform: translateY(-3px) scale(1.05);
      box-shadow: 0 6px 18px rgba(var(--theme-primary-rgb), 0.4);
      background: linear-gradient(135deg, var(--theme-primary) 0%, var(--theme-secondary) 100%);
      color: white;
    }

    .attach-fab:active {
      transform: translateY(0) scale(0.98);
    }

    /* Ø²Ø± Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¯Ø§Ø¦Ø±ÙŠ */
    .send-fab {
      position: absolute;
      left: 12px;
      bottom: 12px;
      width: 56px;
      height: 56px;
      border-radius: 50%;
      border: none;
      background: linear-gradient(135deg, var(--theme-primary) 0%, var(--theme-secondary) 100%);
      color: white;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.5rem;
      transition: all 0.3s ease;
      box-shadow: 0 4px 12px rgba(var(--theme-primary-rgb), 0.4);
      z-index: 10;
    }

    .send-fab:hover {
      transform: translateY(-3px) scale(1.05);
      box-shadow: 0 6px 18px rgba(var(--theme-primary-rgb), 0.6);
    }

    .send-fab:active {
      transform: translateY(0) scale(0.98);
    }

    /* Ù…Ø¬Ù…ÙˆØ¹Ø© Ø§Ù„Ø£Ø²Ø±Ø§Ø± (ØªÙ… Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ù†Ø³Ø® ÙˆØ§Ù„Ù…Ø³Ø­) */
    .button-group {
      display: flex;
      gap: 1.2rem;
      justify-content: flex-end;
    }

    button {
      padding: 0.9rem 1.8rem;
      border: none;
      border-radius: 12px;
      font-family: var(--font-primary);
      font-size: 1.1rem;
      font-weight: 600;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 0.7rem;
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
      background: linear-gradient(135deg, var(--light-charcoal) 0%, var(--carbon) 100%);
      color: var(--theme-text);
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
    }

    button::before {
      content: "";
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
      transform: translateX(-100%);
    }

    button:hover::before {
      animation: shine 1.5s infinite;
    }

    @keyframes shine {
      100% { transform: translateX(100%); }
    }

    button:hover {
      transform: translateY(-3px);
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.4);
    }

    button:active {
      transform: translateY(1px);
    }

    .primary-btn {
      background: linear-gradient(135deg, var(--theme-primary) 0%, var(--theme-secondary) 100%);
      color: white;
      border: 1px solid rgba(var(--theme-primary-rgb), 0.5);
    }

    .primary-btn:hover {
      background: linear-gradient(135deg, #3a7bd5 0%, #8a2be2 100%);
      box-shadow: 0 0 20px rgba(var(--theme-primary-rgb), 0.4);
    }

    .secondary-btn {
      background: linear-gradient(135deg, var(--graphite) 0%, var(--light-charcoal) 100%);
      color: var(--theme-text-secondary);
      border: 1px solid rgba(255, 255, 255, 0.1);
    }

    .secondary-btn:hover {
      background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%);
      border-color: rgba(var(--theme-primary-rgb), 0.3);
    }

    /* Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠ Ø§Ù„Ù…Ø¹Ø¯Ù„ */
    .sidebar {
      position: fixed;
      top: 0;
      right: -350px;
      width: 320px;
      height: 100vh;
      background: var(--dark-charcoal);
      border-left: 1px solid rgba(var(--theme-primary-rgb), 0.3);
      z-index: 1000;
      transition: right 0.3s ease;
      padding: 20px;
      overflow-y: auto;
      box-shadow: -5px 0 15px rgba(0, 0, 0, 0.5);
    }

    .sidebar.open {
      right: 0;
    }

    .sidebar-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
      padding-bottom: 15px;
      border-bottom: 1px solid rgba(var(--theme-primary-rgb), 0.3);
    }

    .sidebar-title {
      font-size: 1.3rem;
      color: var(--theme-primary);
    }

    /* ØªØ¹Ø¯ÙŠÙ„: ØªØ­Ø³ÙŠÙ† ØªØµÙ…ÙŠÙ… Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠ */
    .sidebar-controls {
      display: flex;
      flex-direction: column;
      align-items: flex-end;
      gap: 15px; /* Ø²ÙŠØ§Ø¯Ø© Ø§Ù„Ù…Ø³Ø§ÙØ© Ø¨ÙŠÙ† Ø§Ù„Ø£Ø²Ø±Ø§Ø± */
    }

    .close-sidebar {
      background: none;
      border: none;
      color: var(--theme-text-secondary);
      font-size: 1.3rem; /* Ø­Ø¬Ù… Ù…Ù†Ø§Ø³Ø¨ Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø© Ø§Ù„Ø¥ØºÙ„Ø§Ù‚ */
      cursor: pointer;
      padding: 10px;
      border-radius: 8px;
      transition: all 0.3s ease;
      align-self: flex-end; /* Ù…Ø­Ø§Ø°Ø§Ø© Ø¥Ù„Ù‰ Ø§Ù„ÙŠÙ…ÙŠÙ† */
    }

    /* Ø²Ø± Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© ÙÙŠ Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠ */
    .new-chat-btn {
      background: none;
      border: none;
      color: var(--theme-text-secondary);
      font-size: 2rem; /* Ø²ÙŠØ§Ø¯Ø© Ø­Ø¬Ù… Ø§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø© */
      cursor: pointer;
      padding: 12px;
      border-radius: 12px;
      transition: all 0.3s ease;
      align-self: flex-end; /* Ù…Ø­Ø§Ø°Ø§Ø© Ø¥Ù„Ù‰ Ø§Ù„ÙŠÙ…ÙŠÙ† */
    }

    .new-chat-btn:hover {
      background: rgba(var(--theme-primary-rgb), 0.2);
      transform: scale(1.1);
    }

    .close-sidebar:hover {
      background: rgba(var(--theme-primary-rgb), 0.1);
      transform: scale(1.05);
    }

    /* Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø¯Ø§Ø®Ù„ Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠ */
    .settings-menu {
      width: 100%;
      background: var(--graphite);
      border: 1px solid rgba(var(--theme-primary-rgb), 0.3);
      border-radius: 8px;
      padding: 15px;
      margin-bottom: 20px;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
      z-index: 1001;
    }

    .settings-option {
      padding: 10px 15px;
      color: var(--theme-text-secondary);
      cursor: pointer;
      border-radius: 6px;
      transition: all 0.2s ease;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .settings-option:hover {
      background: rgba(var(--theme-primary-rgb), 0.2);
    }

    /* Ø®ÙŠØ§Ø±Ø§Øª Ø§Ù„Ø³Ù…Ø§Øª */
    .theme-option.active {
      background: rgba(var(--theme-primary-rgb), 0.3);
      border-left: 3px solid var(--theme-primary);
    }

    .conversation-list {
      list-style: none;
    }

    .conversation-item {
      padding: 12px 15px;
      margin-bottom: 10px;
      background: rgba(255, 255, 255, 0.05);
      border-radius: 8px;
      border: 1px solid rgba(255, 255, 255, 0.1);
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .conversation-item:hover {
      background: rgba(var(--theme-primary-rgb), 0.1);
      border-color: var(--theme-primary);
    }

    .conversation-title {
      font-size: 1rem;
      margin-bottom: 5px;
      color: var(--theme-text);
    }

    .conversation-preview {
      font-size: 0.85rem;
      color: #aaa;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }

    .conversation-actions {
      display: flex;
      gap: 10px;
      margin-top: 8px;
    }

    .conv-btn {
      background: none;
      border: none;
      color: var(--theme-text-secondary);
      font-size: 0.9rem;
      cursor: pointer;
      padding: 4px 8px;
      border-radius: 4px;
      transition: all 0.2s ease;
    }

    .conv-btn:hover {
      background: rgba(var(--theme-primary-rgb), 0.2);
    }

    /* Ø§Ù„ØªØ°ÙŠÙŠÙ„ Ø¨ØªØµÙ…ÙŠÙ… Ø¹ØµØ±ÙŠ */
    .app-footer {
      text-align: center;
      padding: 1.2rem;
      background: linear-gradient(90deg, var(--primary-black) 0%, var(--graphite) 100%);
      color: var(--theme-text-secondary);
      font-size: 0.95rem;
      border-top: 1px solid rgba(var(--theme-primary-rgb), 0.2);
    }

    /* Ù†Ù‚Ø§Ø· Ø§Ù„ØªØ­Ù…ÙŠÙ„ */
    .loading-dots {
      display: flex;
      justify-content: center;
      padding: 15px;
    }

    .loading-dots span {
      display: inline-block;
      width: 12px;
      height: 12px;
      border-radius: 50%;
      background: var(--theme-primary);
      margin: 0 5px;
      animation: bounce 1.4s infinite ease-in-out both;
    }

    .loading-dots span:nth-child(1) { animation-delay: -0.32s; }
    .loading-dots span:nth-child(2) { animation-delay: -0.16s; }

    @keyframes bounce {
      0%, 80%, 100% { transform: scale(0); }
      40% { transform: scale(1); }
    }

    /* ØªØ£Ø«ÙŠØ±Ø§Øª Ù…ØªÙ‚Ø¯Ù…Ø© Ù„Ù„Ø´Ø§Ø´Ø© */
    .particles {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: 1;
    }

    .particle {
      position: absolute;
      background: var(--theme-primary);
      border-radius: 50%;
      opacity: 0.2;
      animation: float 15s infinite linear;
    }

    @keyframes float {
      0% { transform: translateY(0) translateX(0); opacity: 0; }
      10% { opacity: 0.2; }
      100% { transform: translateY(-100vh) translateX(50px); opacity: 0; }
    }

    /* Ø±Ø³Ø§Ù„Ø© Toast */
    .toast {
      position: fixed;
      bottom: 100px;
      left: 50%;
      transform: translateX(-50%);
      background: rgba(0, 0, 0, 0.8);
      color: white;
      padding: 12px 24px;
      border-radius: 8px;
      z-index: 9999;
      font-size: 0.95rem;
      opacity: 0;
      transition: opacity 0.3s;
      pointer-events: none;
      border: 1px solid rgba(var(--theme-primary-rgb), 0.5);
    }

    .toast.show {
      opacity: 1;
    }

    /* Ù†Ø§ÙØ°Ø© Ø§Ù„Ø¯Ø¹Ù… */
    .support-modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.8);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 10001;
      opacity: 0;
      visibility: hidden;
      transition: all 0.3s ease;
    }

    .support-modal.active {
      opacity: 1;
      visibility: visible;
    }

    .support-content {
      background: var(--dark-charcoal);
      padding: 2rem;
      border-radius: 16px;
      max-width: 500px;
      width: 90%;
      border: 2px solid var(--theme-primary);
      box-shadow: 0 0 30px rgba(var(--theme-primary-rgb), 0.3);
    }

    .support-title {
      text-align: center;
      color: var(--theme-primary);
      margin-bottom: 1.5rem;
      font-size: 1.5rem;
    }

    .support-options {
      display: flex;
      flex-direction: column;
      gap: 20px;
      margin-top: 1.5rem;
    }

    .support-option {
      background: rgba(255, 255, 255, 0.05);
      border-radius: 12px;
      padding: 20px;
      border: 1px solid rgba(var(--theme-primary-rgb), 0.3);
      transition: all 0.3s ease;
    }

    .support-option:hover {
      background: rgba(255, 255, 255, 0.08);
      border-color: var(--theme-primary);
      transform: translateY(-3px);
    }

    .option-title {
      color: var(--theme-primary);
      font-size: 1.2rem;
      margin-bottom: 10px;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .option-description {
      color: var(--theme-text-secondary);
      font-size: 0.95rem;
      line-height: 1.6;
      margin-bottom: 15px;
    }

    .vodafone-number {
      background: rgba(var(--theme-primary-rgb), 0.1);
      padding: 12px 15px;
      border-radius: 8px;
      font-family: monospace;
      font-size: 1.3rem;
      color: var(--theme-primary);
      text-align: center;
      margin: 10px 0;
      border: 1px dashed rgba(var(--theme-primary-rgb), 0.5);
    }

    .copy-btn {
      background: rgba(var(--theme-primary-rgb), 0.2);
      color: var(--theme-primary);
      border: none;
      padding: 8px 15px;
      border-radius: 6px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      font-size: 0.9rem;
      margin-top: 10px;
      width: 100%;
      transition: all 0.3s ease;
    }

    .copy-btn:hover {
      background: rgba(var(--theme-primary-rgb), 0.3);
      transform: translateY(-2px);
    }

    .video-option {
      background: rgba(76, 175, 80, 0.1);
      border-color: rgba(76, 175, 80, 0.3);
    }

    .video-option:hover {
      border-color: #4CAF50;
    }

    .video-option .option-title {
      color: #4CAF50;
    }

    .close-support {
      margin-top: 20px;
      width: 100%;
    }

    /* Ø§Ù„ØªØµÙ…ÙŠÙ… Ø§Ù„Ù…ØªØ¬Ø§ÙˆØ¨ */
    @media (max-width: 768px) {
      .app-container {
        max-width: 100%;
      }
      
      .app-header {
        padding: 1rem;
        flex-direction: column;
        gap: 15px;
        position: relative;
      }
      
      /* Ù†Ù‚Ù„ Ø²Ø± Ø§Ù„Ù‡Ø§Ù…Ø¨Ø±Ø¬Ø± Ø¥Ù„Ù‰ Ø£Ø¹Ù„Ù‰ Ø§Ù„ÙŠÙ…ÙŠÙ† */
      .header-controls {
        order: -1;
        width: 100%;
        justify-content: flex-end;
        position: absolute;
        right: 12px;
        top: 12px;
      }
      
      .logo-main h1 {
        font-size: 2.2rem;
      }
      
      .main-logo {
        width: 100px;
        height: 100px;
      }
      
      .chat-container {
        padding: 1rem;
      }
      
      .chat-history {
        gap: 10px; /* ØªÙ‚Ù„ÙŠÙ„ Ø§Ù„Ù…Ø³Ø§ÙØ© Ø£ÙƒØ«Ø± Ø¹Ù„Ù‰ Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„ */
        padding: 1rem;
        height: 60vh; /* ØªÙ‚Ù„ÙŠÙ„ Ø§Ù„Ø§Ø±ØªÙØ§Ø¹ Ø¹Ù„Ù‰ Ø§Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„ØµØºÙŠØ±Ø© */
      }
      
      .message {
        max-width: 95% !important;
        padding: 0.6rem !important;
        font-size: 1rem;
      }
      
      .user-message, .bot-message {
        max-width: 95% !important;
      }
      
      .message p {
        padding: 4px 8px; /* ØªÙ‚Ù„ÙŠÙ„ padding Ù„Ù„Ù†Øµ Ø¹Ù„Ù‰ Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„ */
      }
      
      .message-actions {
        gap: 6px; /* ØªÙ‚Ù„ÙŠÙ„ Ø§Ù„Ù…Ø³Ø§ÙØ© Ø¨ÙŠÙ† Ø§Ù„Ø£Ø²Ø±Ø§Ø± */
      }
      
      .message-btn {
        width: 40px !important;
        height: 40px !important;
        min-width: 40px !important;
        font-size: 14px !important;
      }
      
      .send-fab {
        width: 50px;
        height: 50px;
        font-size: 1.3rem;
      }
      
      .attach-fab {
        width: 50px;
        height: 50px;
        font-size: 1.3rem;
        left: 68px;
      }
      
      textarea {
        padding-left: 8.5rem; /* Ø²ÙŠØ§Ø¯Ø© Ø§Ù„Ù…Ø³Ø§Ø­Ø© Ù„Ù„Ø£Ø²Ø±Ø§Ø± Ø¹Ù„Ù‰ Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„ */
        min-height: 100px;
      }
      
      .sidebar {
        width: 280px;
      }
      
      /* ØªØ¹Ø¯ÙŠÙ„Ø§Øª Ù„Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠ Ø¹Ù„Ù‰ Ø§Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„ØµØºÙŠØ±Ø© */
      .sidebar-controls {
        gap: 12px;
      }
      
      .new-chat-btn {
        font-size: 1.8rem;
        padding: 10px;
      }
      
      .close-sidebar {
        font-size: 1.2rem;
        padding: 8px;
      }
      
      .login-btn {
        padding: 6px 12px;
        font-size: 0.9rem;
      }
      
      .user-name {
        max-width: 80px;
      }
      
      .support-content {
        padding: 1.5rem;
      }
      
      .vodafone-number {
        font-size: 1.1rem;
        padding: 10px;
      }
    }

    /* ØªØµÙ…ÙŠÙ… Ø®Ø§Øµ Ù„Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„ØµØºÙŠØ±Ø© Ø¬Ø¯Ø§Ù‹ */
    @media (max-width: 360px) {
      .message-actions {
        gap: 4px;
      }
      
      .message-btn {
        width: 36px !important;
        height: 36px !important;
        min-width: 36px !important;
        font-size: 13px !important;
      }
      
      .login-btn {
        padding: 4px 8px;
        font-size: 0.8rem;
      }
    }

    /* Ø¥Ø¶Ø§ÙØ© aria-live Ù„Ù„ÙˆØµÙˆÙ„ÙŠØ© */
    .chat-history {
      aria-live: polite;
    }
  </style>
</head>
<body>
  <!-- Ø¬Ø³ÙŠÙ…Ø§Øª Ù…ØªØ­Ø±ÙƒØ© Ù„Ù„Ø®Ù„ÙÙŠØ© -->
  <div class="particles" id="particles"></div>
  
  <!-- Ø±Ø³Ø§Ù„Ø© Toast -->
  <div class="toast" id="toast"></div>
  
  <!-- Ù†Ø§ÙØ°Ø© Ø§Ù„Ø¯Ø¹Ù… -->
  <div class="support-modal" id="supportModal">
    <div class="support-content">
      <h3 class="support-title">Ø§Ø¯Ø¹Ù… Ø³Ø¹Ø¯.AI</h3>
      <p style="text-align: center; color: var(--theme-text-secondary); margin-bottom: 1.5rem;">
        Ø¯Ø¹Ù…Ùƒ ÙŠØ³Ø§Ø¹Ø¯Ù†Ø§ Ø¹Ù„Ù‰ Ø§Ù„Ø§Ø³ØªÙ…Ø±Ø§Ø± ÙˆØ§Ù„ØªØ·ÙˆÙŠØ±. Ø§Ø®ØªØ± Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¯Ø¹Ù… Ø§Ù„Ù…Ù†Ø§Ø³Ø¨Ø© Ù„Ùƒ:
      </p>
      
      <div class="support-options">
        <div class="support-option">
          <div class="option-title">
            <i class="fas fa-mobile-alt"></i>
            <span>ÙÙˆØ¯Ø§ÙÙˆÙ† ÙƒØ§Ø´ (Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† ÙÙŠ Ù…ØµØ±)</span>
          </div>
          <div class="option-description">
            ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„Ø¯Ø¹Ù… Ø§Ù„Ù…Ø§Ø¯ÙŠ Ø¹Ù† Ø·Ø±ÙŠÙ‚ ØªØ­ÙˆÙŠÙ„ Ø£ÙŠ Ù…Ø¨Ù„Øº Ø¹Ø¨Ø± ÙÙˆØ¯Ø§ÙÙˆÙ† ÙƒØ§Ø´ Ø¥Ù„Ù‰ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„ØªØ§Ù„ÙŠ:
          </div>
          <div class="vodafone-number" id="vodafoneNumber">01030787655</div>
          <button class="copy-btn" id="copyVodafoneBtn">
            <i class="fas fa-copy"></i>
            Ù†Ø³Ø® Ø§Ù„Ø±Ù‚Ù…
          </button>
        </div>
        
        <div class="support-option video-option">
          <div class="option-title">
            <i class="fas fa-video"></i>
            <span>Ø¥Ù†Ø´Ø§Ø¡ ÙÙŠØ¯ÙŠÙˆ ØªØ±ÙˆÙŠØ¬ÙŠ</span>
          </div>
          <div class="option-description">
            Ø¥Ø°Ø§ ÙƒÙ†Øª Ù„Ø§ ØªØ³ØªØ·ÙŠØ¹ Ø§Ù„Ø¯Ø¹Ù… Ù…Ø§Ø¯ÙŠØ§Ù‹ØŒ ÙŠÙ…ÙƒÙ†Ùƒ Ù…Ø³Ø§Ø¹Ø¯ØªÙ†Ø§ Ø¹Ù† Ø·Ø±ÙŠÙ‚ Ø¥Ù†Ø´Ø§Ø¡ ÙÙŠØ¯ÙŠÙˆ ØªØªØ­Ø¯Ø« ÙÙŠÙ‡ Ø¹Ù† Ø³Ø¹Ø¯.AI ÙˆØªØ¬Ø±Ø¨ØªÙƒ Ù…Ø¹Ù‡ØŒ Ø«Ù… Ù†Ø´Ø±Ù‡ Ø¹Ù„Ù‰ Ù…Ù†ØµØ§Øª Ø§Ù„ØªÙˆØ§ØµÙ„ Ø§Ù„Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠ Ù…Ø¹ ÙˆØ¶Ø¹ Ø±Ø§Ø¨Ø· Ø§Ù„Ù…ÙˆÙ‚Ø¹.
          </div>
          <div class="option-description" style="color: #4CAF50; font-weight: bold;">
            Ù‡Ø°Ø§ Ø§Ù„Ø¯Ø¹Ù… ØºÙŠØ± Ø§Ù„Ù…Ø§Ø¯ÙŠ Ù„Ù‡ Ù‚ÙŠÙ…Ø© ÙƒØ¨ÙŠØ±Ø© Ø¨Ø§Ù„Ù†Ø³Ø¨Ø© Ù„Ù†Ø§ ÙˆÙŠØ³Ø§Ø¹Ø¯ ÙÙŠ Ø§Ù†ØªØ´Ø§Ø± Ø§Ù„ØªØ·Ø¨ÙŠÙ‚!
          </div>
        </div>
      </div>
      
      <button class="secondary-btn close-support" id="closeSupportBtn">
        <i class="fas fa-times"></i>
        Ø¥ØºÙ„Ø§Ù‚
      </button>
    </div>
  </div>
  
  <!-- Ø¥Ø¯Ø®Ø§Ù„ Ù…Ù„Ù Ù…Ø®ÙÙŠ -->
  <input type="file" id="fileInput" accept=".txt,.py,.js,.ts,.json,.html,.css,.md,.xml" hidden>
  
  <!-- Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠ Ø§Ù„Ù…Ø¹Ø¯Ù„ -->
  <div class="sidebar" id="sidebar">
    <div class="sidebar-header">
      <h3 class="sidebar-title">Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø§Øª ÙˆØ§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</h3>
      <div class="sidebar-controls">
        <button class="new-chat-btn" id="newChatBtn" title="Ø¨Ø¯Ø¡ Ù…Ø­Ø§Ø¯Ø«Ø© Ø¬Ø¯ÙŠØ¯Ø©">
          <i class="fas fa-plus"></i>
        </button>
        <button class="close-sidebar" id="closeSidebar">
          <i class="fas fa-times"></i>
        </button>
      </div>
    </div>

    <!-- Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø¯Ø§Ø®Ù„ Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠ -->
    <div class="settings-menu" id="settingsMenu">
      <div class="settings-option" id="exportChat">
        <i class="fas fa-download"></i> ØªØµØ¯ÙŠØ± Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ©
      </div>
      <div class="settings-option" id="importChat">
        <i class="fas fa-upload"></i> Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ù…Ø­Ø§Ø¯Ø«Ø©
      </div>
      <div class="settings-option" id="resetSettings">
        <i class="fas fa-redo"></i> Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª
      </div>
      <div class="settings-option" id="clearChat">
        <i class="fas fa-trash-alt"></i> Ù…Ø³Ø­ Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ©
      </div>
      
      <!-- Ø®ÙŠØ§Ø±Ø§Øª Ø§Ù„Ø³Ù…Ø§Øª -->
      <div class="settings-option theme-option active" data-theme="dark" id="themeDark">
        <i class="fas fa-moon"></i> Ø§Ù„Ø³Ù…Ø© Ø§Ù„Ø¯Ø§ÙƒÙ†Ø©
      </div>
      <div class="settings-option theme-option" data-theme="light" id="themeLight">
        <i class="fas fa-sun"></i> Ø§Ù„Ø³Ù…Ø© Ø§Ù„ÙØ§ØªØ­Ø©
      </div>
      <div class="settings-option theme-option" data-theme="blue" id="themeBlue">
        <i class="fas fa-palette"></i> Ø§Ù„Ø³Ù…Ø© Ø§Ù„Ø²Ø±Ù‚Ø§Ø¡
      </div>
      <div class="settings-option theme-option" data-theme="green" id="themeGreen">
        <i class="fas fa-leaf"></i> Ø§Ù„Ø³Ù…Ø© Ø§Ù„Ø®Ø¶Ø±Ø§Ø¡
      </div>
      
      <!-- Ø²Ø± Ø§Ù„Ø¯Ø¹Ù… -->
      <div class="settings-option" id="supportBtn">
        <i class="fas fa-heart" style="color: #ff4757;"></i> Ø§Ø¯Ø¹Ù…Ù†Ø§
      </div>
    </div>

    <!-- Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø§Øª -->
    <ul class="conversation-list" id="conversationList">
      <!-- Ø³ÙŠØªÙ… Ù…Ù„Ø¤Ù‡Ø§ Ø¨Ø§Ù„Ø¬Ø§ÙØ§Ø³ÙƒØ±ÙŠØ¨Øª -->
    </ul>
  </div>
  
  <div class="app-container">
    <div class="app-header">
      <div class="header-controls">
        <!-- Ø²Ø± Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© (Ù‡Ø§Ù…Ø¨Ø±ØºØ±) -->
        <button class="header-btn" id="sidebarToggle">
          <i class="fas fa-bars"></i>
        </button>
      </div>
      <div class="logo-main">
        <img src="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><circle cx='50' cy='50' r='45' fill='none' stroke='%234895ef' stroke-width='3'/><path d='M30,30 L50,70 L70,30' fill='none' stroke='%234895ef' stroke-width='3' stroke-linecap='round'/><circle cx='50' cy='40' r='5' fill='%234895ef'/></svg>" alt="Saad.AI Logo" class="main-logo">
        <h1>Saad.AI</h1>
      </div>
      <div class="subtitle">Ù†Ø¸Ø§Ù… Ø°ÙƒØ§Ø¡ Ø§ØµØ·Ù†Ø§Ø¹ÙŠ Ù…ØªØ·ÙˆØ± Ø°Ø§ØªÙŠ Ø§Ù„ØªØ¹Ù„Ù… ÙˆØ§Ù„ØªÙƒÙŠÙØŒ ØµÙ…Ù… Ø®ØµÙŠØµØ§Ù‹ Ù„ØªÙ‚Ø¯ÙŠÙ… Ø­Ù„ÙˆÙ„ Ø°ÙƒÙŠØ© ÙˆØ¥Ø¨Ø¯Ø§Ø¹ÙŠØ© ÙÙŠ ÙƒÙ„ Ø§Ù„Ù…Ø¬Ø§Ù„Ø§Øª</div>
    </div>

    <div class="chat-container">
      <div class="chat-history" id="chatHistory">
        <div class="welcome-message">
          <p>Ù…Ø±Ø­Ø¨Ø§Ù‹! Ø£Ù†Ø§ Ø³Ø¹Ø¯.AIØŒ Ø±ÙÙŠÙ‚Ùƒ Ø§Ù„Ø°ÙƒÙŠ ÙÙŠ Ø§Ù„Ø¹Ø§Ù„Ù… Ø§Ù„Ø±Ù‚Ù…ÙŠ. ÙƒÙŠÙ ÙŠÙ…ÙƒÙ†Ù†ÙŠ Ù…Ø³Ø§Ø¹Ø¯ØªÙƒ Ø§Ù„ÙŠÙˆÙ…ØŸ</p>
        </div>
      </div>

      <div class="input-area">
        <textarea id="userInput" placeholder="Ø§ÙƒØªØ¨ Ø±Ø³Ø§Ù„ØªÙƒ Ù‡Ù†Ø§... (Shift+Enter Ù„Ù„Ø³Ø·Ø± Ø§Ù„Ø¬Ø¯ÙŠØ¯)"></textarea>
        <button class="attach-fab" id="attachButton" title="Ø±ÙØ¹ Ù…Ù„Ù Ù†ØµÙŠ" aria-label="Ø±ÙØ¹ Ù…Ù„Ù">
          <i class="fas fa-paperclip"></i>
        </button>
        <button class="send-fab" id="sendButton" title="Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø±Ø³Ø§Ù„Ø©" aria-label="Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø±Ø³Ø§Ù„Ø©">
          <i class="fas fa-paper-plane"></i>
        </button>
      </div>
    </div>

    <div class="app-footer">
      <p>Ø§Ù„Ø¥ØµØ¯Ø§Ø± Ø§Ù„Ø®Ø§Ø±Ù‚ (Saad01 Ultimate Edition) &copy; 2025 - Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø©</p>
    </div>
  </div>
  
  <script>
  // ==================== Ù†Ø¸Ø§Ù… ØªØ¹Ø±ÙŠÙ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ====================
  class UserIdentity {
    constructor() {
      this.storageKey = 'saad_ai_user_id';
      this.cookieName = 'saad_uid';
      this.userId = null;
      this.init();
    }
    
    init() {
      // 1. Ø¬Ø±Ø¨ ØªØ­Ù…ÙŠÙ„ Ù…Ù† localStorage
      this.userId = localStorage.getItem(this.storageKey);
      
      // 2. Ø¥Ø°Ø§ Ù…Ø§ÙÙŠØ´ØŒ Ø¬Ø±Ø¨ Ø§Ù„ÙƒÙˆÙƒÙŠØ²
      if (!this.userId) {
        this.userId = this.getCookie(this.cookieName);
      }
      
      // 3. Ø¥Ø°Ø§ Ù…Ø§ÙÙŠØ´ØŒ Ø£Ù†Ø´Ø¦ Ø¬Ø¯ÙŠØ¯
      if (!this.userId) {
        this.generateNewId();
      }
      
      console.log('Ù…Ø¹Ø±Ù Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…:', this.userId);
    }
    
    generateNewId() {
      // ØªÙˆÙ„ÙŠØ¯ Ù…Ø¹Ø±Ù ÙØ±ÙŠØ¯
      const timestamp = Date.now().toString(36);
      const randomStr = Math.random().toString(36).substr(2, 12);
      this.userId = `user_${timestamp}_${randomStr}`;
      
      // Ø­ÙØ¸ ÙÙŠ localStorage
      localStorage.setItem(this.storageKey, this.userId);
      
      // Ø­ÙØ¸ ÙÙŠ ÙƒÙˆÙƒÙŠØ² (ÙƒÙ†Ø³Ø®Ø© Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©)
      this.setCookie(this.cookieName, this.userId, 30); // 30 ÙŠÙˆÙ…
      
      // Ø¥Ø¹Ù„Ø§Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)
      console.log('âœ… ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø¹Ø±Ù Ø¬Ø¯ÙŠØ¯ Ù„Ùƒ:', this.userId);
    }
    
    getCookie(name) {
      const cookies = document.cookie.split(';');
      for (let cookie of cookies) {
        const [key, value] = cookie.trim().split('=');
        if (key === name) return value;
      }
      return null;
    }
    
    setCookie(name, value, days) {
      const date = new Date();
      date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));
      document.cookie = `${name}=${value}; expires=${date.toUTCString()}; path=/`;
    }
    
    getId() {
      return this.userId;
    }
    
    clear() {
      localStorage.removeItem(this.storageKey);
      this.setCookie(this.cookieName, '', -1); // Ø­Ø°Ù Ø§Ù„ÙƒÙˆÙƒÙŠØ²
      this.userId = null;
      this.generateNewId(); // Ø¥Ù†Ø´Ø§Ø¡ Ø¬Ø¯ÙŠØ¯ ÙÙˆØ±Ø§Ù‹
    }
  }

  // ==================== Ø¨Ø¯Ø¡ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ ====================
  document.addEventListener('DOMContentLoaded', function() {
    // Ø¥Ù†Ø´Ø§Ø¡ Ù†Ø³Ø®Ø© ÙˆØ§Ø­Ø¯Ø© Ø¹Ø§Ù…Ø© Ù„Ù†Ø¸Ø§Ù… ØªØ¹Ø±ÙŠÙ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
    window.saadUser = new UserIdentity();
    
    // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ø¹Ù†Ø§ØµØ±
    const userInput = document.getElementById('userInput');
    const sendButton = document.getElementById('sendButton');
    const attachButton = document.getElementById('attachButton');
    const fileInput = document.getElementById('fileInput');
    const chatHistory = document.getElementById('chatHistory');
    const sidebar = document.getElementById('sidebar');
    const sidebarToggle = document.getElementById('sidebarToggle');
    const closeSidebar = document.getElementById('closeSidebar');
    const newChatBtn = document.getElementById('newChatBtn');
    const settingsMenu = document.getElementById('settingsMenu');
    const conversationList = document.getElementById('conversationList');
    const toast = document.getElementById('toast');
    
    // Ø¹Ù†Ø§ØµØ± Ø§Ù„Ø¯Ø¹Ù… Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©
    const supportBtn = document.getElementById('supportBtn');
    const supportModal = document.getElementById('supportModal');
    const closeSupportBtn = document.getElementById('closeSupportBtn');
    const copyVodafoneBtn = document.getElementById('copyVodafoneBtn');
    const vodafoneNumber = document.getElementById('vodafoneNumber');
    
    // Ø§Ù„Ø¹Ù†Ø§ØµØ± Ø§Ù„Ø®Ø§ØµØ© Ø¨Ø§Ù„Ø³Ù…Ø§Øª
    const themeOptions = document.querySelectorAll('.theme-option');
    const themeDark = document.getElementById('themeDark');
    const themeLight = document.getElementById('themeLight');
    const themeBlue = document.getElementById('themeBlue');
    const themeGreen = document.getElementById('themeGreen');
    
    // ØªØ®Ø²ÙŠÙ† Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø§Øª
    let conversations = [];
    let currentConversationId = 'default';
    let conversationTitleGenerated = false;
    let currentTheme = localStorage.getItem('saadai_theme') || 'dark';
    
    // ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø³Ù…Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ©
    applyTheme(currentTheme);
    updateThemeButtons();
    
    // ØªØ­Ù…ÙŠÙ„ Ù…Ø­Ø§Ø¯Ø«Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
    loadUserConversations();
    
    // Ø¥Ù†Ø´Ø§Ø¡ Ø¬Ø³ÙŠÙ…Ø§Øª Ø§Ù„Ø®Ù„ÙÙŠØ©
    function createParticles() {
      const particlesContainer = document.getElementById('particles');
      const particleCount = 30;

      for (let i = 0; i < particleCount; i++) {
        const particle = document.createElement('div');
        particle.classList.add('particle');
        const size = Math.random() * 5 + 1;
        const posX = Math.random() * 100;
        const duration = Math.random() * 20 + 10;
        const delay = Math.random() * 5;
        const color = `hsl(${Math.random() * 360}, 70%, 60%)`;

        particle.style.width = `${size}px`;
        particle.style.height = `${size}px`;
        particle.style.left = `${posX}%`;
        particle.style.background = color;
        particle.style.animationDuration = `${duration}s`;
        particle.style.animationDelay = `${delay}s`;

        particlesContainer.appendChild(particle);
      }
    }
    
    // Ø¹Ø±Ø¶ Ø±Ø³Ø§Ù„Ø© Toast
    function showToast(message, duration = 2000) {
      toast.textContent = message;
      toast.classList.add('show');
      setTimeout(() => {
        toast.classList.remove('show');
      }, duration);
    }
    
    // ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø³Ù…Ø©
    function applyTheme(theme) {
      document.body.classList.remove('theme-light', 'theme-blue', 'theme-green');
      if (theme !== 'dark') {
        document.body.classList.add(`theme-${theme}`);
      }
      
      // ØªØ­Ø¯ÙŠØ« CSS Variables Ù„ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø£Ù„ÙˆØ§Ù† Ø¥Ù„Ù‰ RGB
      updateCSSVariables();
      
      localStorage.setItem('saadai_theme', theme);
      currentTheme = theme;
    }
    
    // ØªØ­Ø¯ÙŠØ« CSS Variables Ù„ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø£Ù„ÙˆØ§Ù† Ø¥Ù„Ù‰ RGB
    function updateCSSVariables() {
      const root = document.documentElement;
      const primaryColor = getComputedStyle(root).getPropertyValue('--theme-primary').trim();
      const secondaryColor = getComputedStyle(root).getPropertyValue('--theme-secondary').trim();
      
      // ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø£Ù„ÙˆØ§Ù† Ø¥Ù„Ù‰ RGB
      function hexToRgb(hex) {
        const result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
        return result ? {
          r: parseInt(result[1], 16),
          g: parseInt(result[2], 16),
          b: parseInt(result[3], 16)
        } : null;
      }
      
      const primaryRGB = hexToRgb(primaryColor);
      const secondaryRGB = hexToRgb(secondaryColor);
      
      if (primaryRGB) {
        root.style.setProperty('--theme-primary-rgb', `${primaryRGB.r}, ${primaryRGB.g}, ${primaryRGB.b}`);
      }
      
      if (secondaryRGB) {
        root.style.setProperty('--theme-secondary-rgb', `${secondaryRGB.r}, ${secondaryRGB.g}, ${secondaryRGB.b}`);
      }
    }
    
    // ØªØ­Ø¯ÙŠØ« Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø³Ù…Ø§Øª
    function updateThemeButtons() {
      themeOptions.forEach(option => {
        option.classList.remove('active');
        if (option.dataset.theme === currentTheme) {
          option.classList.add('active');
        }
      });
    }
    
    // ØªØ­Ù…ÙŠÙ„ Ù…Ø­Ø§Ø¯Ø«Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
    function loadUserConversations() {
      conversations = JSON.parse(localStorage.getItem('saadai_conversations')) || [];
      updateConversationList();
    }
    
    // Ø­ÙØ¸ Ù…Ø­Ø§Ø¯Ø«Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
    function saveConversations() {
      localStorage.setItem('saadai_conversations', JSON.stringify(conversations));
    }
    
    // ==================== ÙˆØ¸Ø§Ø¦Ù Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø®Ø§Ø¯Ù… ====================
    // ÙˆØ¸ÙŠÙØ© Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ Ø¥Ù„Ù‰ Ø§Ù„Ø®Ø§Ø¯Ù… Ù…Ø¹ Ù…Ø¹Ø±Ù Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
    async function sendToSaad(content, type = 'text') {
      const loadingId = showLoading();
      
      try {
        const userId = window.saadUser.getId();
        
        if (!userId) {
          throw new Error('Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ù…Ø¹Ø±Ù Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…');
        }
        
        const response = await fetch('/api/chat', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
            'X-User-ID': userId
          },
          body: JSON.stringify({
            message: content,
            user_id: userId,
            type: type,
            timestamp: new Date().toISOString(),
            language: navigator.language || 'ar'
          })
        });
        
        if (!response.ok) {
          if (response.status === 400) {
            const error = await response.json();
            if (error.reason === 'INVALID_USER_ID') {
              window.saadUser.clear();
              showToast('ğŸ”„ ØªÙ… Ø¥Ø¹Ø§Ø¯Ø© ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ø¬Ù„Ø³Ø©. ÙŠØ±Ø¬Ù‰ Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø©.', 3000);
              throw new Error('INVALID_USER_ID');
            }
          }
          throw new Error(`Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø®Ø§Ø¯Ù…: ${response.status}`);
        }
        
        const data = await response.json();
        removeLoading(loadingId);
        return data;
        
      } catch (error) {
        removeLoading(loadingId);
        if (error.message === 'INVALID_USER_ID') {
          return { error: 'INVALID_USER_ID' };
        }
        console.error('âŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„:', error);
        return {
          'Ø±Ø¯': 'Ø¹Ø°Ø±Ø§Ù‹ØŒ Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø®Ø§Ø¯Ù….',
          'error': error.message
        };
      }
    }
    
    // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ø¬Ø³ÙŠÙ…Ø§Øª
    createParticles();
    updateCSSVariables(); // ØªØ­Ø¯ÙŠØ« CSS Variables Ø¹Ù†Ø¯ Ø§Ù„ØªØ­Ù…ÙŠÙ„
    
    // ØªØ­Ø¯ÙŠØ« Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø§Øª
    function updateConversationList() {
      conversationList.innerHTML = '';
      
      if (conversations.length === 0) {
        conversationList.innerHTML = '<p style="color: #777; text-align: center;">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø­Ø§Ø¯Ø«Ø§Øª Ø³Ø§Ø¨Ù‚Ø©</p>';
        return;
      }
      
      conversations.forEach((conv, index) => {
        const li = document.createElement('li');
        li.className = 'conversation-item';
        li.dataset.id = conv.id;
        
        const title = conv.title || `Ù…Ø­Ø§Ø¯Ø«Ø© ${index + 1}`;
        const preview = conv.messages && conv.messages.length > 0 
          ? conv.messages[0].text.substring(0, 50) + '...'
          : 'Ù„Ø§ ØªÙˆØ¬Ø¯ Ø±Ø³Ø§Ø¦Ù„';
        
        li.innerHTML = `
          <div class="conversation-title">${title}</div>
          <div class="conversation-preview">${preview}</div>
          <div class="conversation-actions">
            <button class="conv-btn edit-conv" title="ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø¹Ù†ÙˆØ§Ù†"><i class="fas fa-edit"></i></button>
            <button class="conv-btn delete-conv" title="Ø­Ø°Ù Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø©"><i class="fas fa-trash"></i></button>
          </div>
        `;
        
        // Ø­Ø¯Ø« ÙØªØ­ Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø©
        li.querySelector('.conversation-title').addEventListener('click', () => {
          loadConversation(conv.id);
          sidebar.classList.remove('open');
        });
        
        // Ø­Ø¯Ø« ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø¹Ù†ÙˆØ§Ù†
        li.querySelector('.edit-conv').addEventListener('click', (e) => {
          e.stopPropagation();
          const newTitle = prompt('Ø£Ø¯Ø®Ù„ Ø§Ù„Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø¬Ø¯ÙŠØ¯:', title);
          if (newTitle && newTitle.trim()) {
            conv.title = newTitle.trim();
            saveConversations();
            updateConversationList();
          }
        });
        
        // Ø­Ø¯Ø« Ø­Ø°Ù Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø©
        li.querySelector('.delete-conv').addEventListener('click', (e) => {
          e.stopPropagation();
          if (confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ù‡ Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø©ØŸ')) {
            conversations = conversations.filter(c => c.id !== conv.id);
            saveConversations();
            updateConversationList();
          }
        });
        
        conversationList.appendChild(li);
      });
    }
    
    // ØªØ­Ù…ÙŠÙ„ Ù…Ø­Ø§Ø¯Ø«Ø©
    function loadConversation(id) {
      const conv = conversations.find(c => c.id === id);
      if (!conv) return;
      
      chatHistory.innerHTML = '<div class="welcome-message"><p>ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø©...</p></div>';
      
      setTimeout(() => {
        chatHistory.innerHTML = '';
        conv.messages.forEach(msg => {
          addMessage(msg.text, msg.sender, false, msg.id);
        });
        currentConversationId = id;
        conversationTitleGenerated = true;
      }, 300);
    }
    
    // Ø­ÙØ¸ Ø§Ù„Ø±Ø³Ø§Ù„Ø© ÙÙŠ Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ©
    function saveMessage(text, sender, messageId, conversationTitle = null) {
      let conv = conversations.find(c => c.id === currentConversationId);
      
      if (!conv) {
        conv = {
          id: currentConversationId,
          title: conversationTitle || text.substring(0, 20) + '...',
          messages: [],
          created: new Date().toISOString()
        };
        conversations.push(conv);
      }
      
      conv.messages.push({
        id: messageId || Date.now().toString(),
        text: text,
        sender: sender,
        timestamp: new Date().toISOString()
      });
      
      if (conversationTitle && !conv.title) {
        conv.title = conversationTitle;
      }
      
      saveConversations();
      updateConversationList();
    }
    
    // Ø§Ù‚ØªØ±Ø§Ø­ Ø¹Ù†ÙˆØ§Ù† Ù„Ù„Ù…Ø­Ø§Ø¯Ø«Ø©
    async function suggestConversationTitle(userMessage, aiResponse) {
      try {
        const response = await fetch('/api/suggest_title', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify({
            user_message: userMessage,
            ai_response: aiResponse
          })
        });
        
        if (!response.ok) {
          throw new Error(`HTTP error! status: ${response.status}`);
        }
        
        const data = await response.json();
        return data.title;
      } catch (error) {
        console.error('Error suggesting title:', error);
        return null;
      }
    }
    
    // Ø¥Ø±Ø³Ø§Ù„ Ø¨Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ Ø¥Ù†ØªØ±
    userInput.addEventListener('keypress', function(e) {
      if (e.key === 'Enter' && !e.shiftKey) {
        e.preventDefault();
        sendMessage();
      }
    });
    
    // Ø­Ø¯Ø« Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø±Ø³Ø§Ù„Ø©
    sendButton.addEventListener('click', sendMessage);
    
    // Ø­Ø¯Ø« Ø±ÙØ¹ Ø§Ù„Ù…Ù„Ù
    attachButton.addEventListener('click', () => {
      fileInput.click();
    });
    
    fileInput.addEventListener('change', handleFileUpload);
    
    async function handleFileUpload(event) {
      const file = event.target.files[0];
      if (!file) return;
      
      // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ù†ÙˆØ¹ Ø§Ù„Ù…Ù„Ù
      const allowedExtensions = ['.txt', '.py', '.js', '.ts', '.json', '.html', '.css', '.md', '.xml'];
      const fileExt = '.' + file.name.split('.').pop().toLowerCase();
      if (!allowedExtensions.includes(fileExt)) {
        showToast('Ù†ÙˆØ¹ Ø§Ù„Ù…Ù„Ù ØºÙŠØ± Ù…Ø³Ù…ÙˆØ­ Ø¨Ù‡. ÙŠØ³Ù…Ø­ ÙÙ‚Ø· Ø¨Ø§Ù„Ù…Ù„ÙØ§Øª Ø§Ù„Ù†ØµÙŠØ© ÙˆØ§Ù„Ø¨Ø±Ù…Ø¬ÙŠØ©.', 3000);
        fileInput.value = '';
        return;
      }
      
      const reader = new FileReader();
      reader.onload = async function(e) {
        const fileContent = e.target.result;
        const messageId = Date.now().toString();
        const fileName = file.name;
        const messageText = `[Ù…Ù„Ù Ù…Ø±ÙÙ‚: ${fileName}]\n\n${fileContent}`;
        
        addMessage(messageText, 'user', true, messageId);
        saveMessage(messageText, 'user', messageId);
        
        // Ø¥Ø±Ø³Ø§Ù„ Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ù…Ù„Ù Ø¥Ù„Ù‰ Ø§Ù„Ø®Ø§Ø¯Ù… Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ø¬Ø¯ÙŠØ¯
        try {
          const data = await sendToSaad(messageText, 'file');
          
          if (data.error && data.error === 'INVALID_USER_ID') {
            addMessage('Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø¬Ù„Ø³Ø©. ÙŠØ±Ø¬Ù‰ Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø©.', 'bot', true);
            saveMessage('Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø¬Ù„Ø³Ø©. ÙŠØ±Ø¬Ù‰ Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø©.', 'bot');
            return;
          }
          
          let botResponse = '';
          
          if (data.Ø±Ø¯) {
            botResponse = data.Ø±Ø¯;
            addMessage(botResponse, 'bot', true);
            saveMessage(botResponse, 'bot');
          } else if (data.responses) {
            const responses = [
              `[ØªÙ‚Ù†ÙŠ] ${data.responses.technical || 'Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø±Ø¯ ØªÙ‚Ù†ÙŠ'}`,
              `[Ø¹Ù…Ù„ÙŠ] ${data.responses.practical || 'Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø±Ø¯ Ø¹Ù…Ù„ÙŠ'}`,
              `[Ø¥Ø¨Ø¯Ø§Ø¹ÙŠ] ${data.responses.creative || 'Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø±Ø¯ Ø¥Ø¨Ø¯Ø§Ø¹ÙŠ'}`
            ];
            botResponse = responses.join('\n');
            responses.forEach(response => {
              addMessage(response, 'bot', true);
              saveMessage(response, 'bot');
            });
          } else {
            botResponse = 'ØªÙ„Ù‚ÙŠØª Ø±Ø¯Ù‹Ø§ ØºÙŠØ± Ù…ØªÙˆÙ‚Ø¹ Ù…Ù† Ø§Ù„Ø®Ø§Ø¯Ù…';
            addMessage(botResponse, 'bot', true);
            saveMessage(botResponse, 'bot');
          }
          
          // Ø§Ù‚ØªØ±Ø§Ø­ Ø¹Ù†ÙˆØ§Ù† Ù„Ù„Ù…Ø­Ø§Ø¯Ø«Ø© Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ù‡Ø°Ù‡ Ø£ÙˆÙ„ Ø±Ø³Ø§Ù„Ø© Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙÙŠ Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ©
          if (!conversationTitleGenerated) {
            const conv = conversations.find(c => c.id === currentConversationId);
            if (conv && conv.messages && conv.messages.filter(m => m.sender === 'user').length === 1) {
              const suggestedTitle = await suggestConversationTitle(messageText, botResponse);
              if (suggestedTitle) {
                conv.title = suggestedTitle;
                saveConversations();
                updateConversationList();
              }
              conversationTitleGenerated = true;
            }
          }
        } catch (error) {
          console.error('Error:', error);
          addMessage(`Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ù…Ù„Ù: ${error.message}`, 'bot', true);
          saveMessage(`Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ù…Ù„Ù: ${error.message}`, 'bot');
        }
      };
      
      reader.readAsText(file);
      fileInput.value = '';
    }
    
    // ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠ (ÙŠØ¸Ù‡Ø± Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø§Øª ÙˆØ§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ù…Ø¹Ø§Ù‹)
    sidebarToggle.addEventListener('click', () => {
      sidebar.classList.toggle('open');
    });
    
    closeSidebar.addEventListener('click', () => {
      sidebar.classList.remove('open');
    });
    
    // Ø£Ø­Ø¯Ø§Ø« Ø§Ù„Ø³Ù…Ø§Øª
    themeOptions.forEach(option => {
      option.addEventListener('click', () => {
        const theme = option.dataset.theme;
        applyTheme(theme);
        updateThemeButtons();
        showToast(`ØªÙ… ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø³Ù…Ø©: ${option.textContent.trim()}`);
      });
    });
    
    // Ø¨Ø¯Ø¡ Ù…Ø­Ø§Ø¯Ø«Ø© Ø¬Ø¯ÙŠØ¯Ø©
    newChatBtn.addEventListener('click', () => {
      currentConversationId = 'default_' + Date.now();
      conversationTitleGenerated = false;
      
      chatHistory.innerHTML = `
        <div class="welcome-message">
          <p>Ù…Ø±Ø­Ø¨Ø§Ù‹! Ø£Ù†Ø§ Ø³Ø¹Ø¯.AIØŒ Ø±ÙÙŠÙ‚Ùƒ Ø§Ù„Ø°ÙƒÙŠ ÙÙŠ Ø§Ù„Ø¹Ø§Ù„Ù… Ø§Ù„Ø±Ù‚Ù…ÙŠ. ÙƒÙŠÙ ÙŠÙ…ÙƒÙ†Ù†ÙŠ Ù…Ø³Ø§Ø¹Ø¯ØªÙƒ Ø§Ù„ÙŠÙˆÙ…ØŸ</p>
        </div>
      `;
      
      userInput.value = '';
      userInput.focus();
      sidebar.classList.remove('open');
      showToast('ØªÙ… Ø¨Ø¯Ø¡ Ù…Ø­Ø§Ø¯Ø«Ø© Ø¬Ø¯ÙŠØ¯Ø©');
    });
    
    // ØªØµØ¯ÙŠØ± Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ©
    document.getElementById('exportChat').addEventListener('click', () => {
      const messages = Array.from(document.querySelectorAll('.message')).map(msg => ({
        sender: msg.classList.contains('user-message') ? 'user' : 'bot',
        text: msg.querySelector('p').textContent,
        time: msg.querySelector('.message-time').textContent
      }));
      
      const dataStr = JSON.stringify(messages, null, 2);
      const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);
      
      const exportFileDefaultName = `saadai_chat_${new Date().toISOString().split('T')[0]}.json`;
      
      const linkElement = document.createElement('a');
      linkElement.setAttribute('href', dataUri);
      linkElement.setAttribute('download', exportFileDefaultName);
      linkElement.click();
      
      showToast('ØªÙ… ØªØµØ¯ÙŠØ± Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø© Ø¨Ù†Ø¬Ø§Ø­');
    });
    
    // Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ù…Ø­Ø§Ø¯Ø«Ø©
    document.getElementById('importChat').addEventListener('click', () => {
      const input = document.createElement('input');
      input.type = 'file';
      input.accept = '.json';
      
      input.onchange = e => {
        const file = e.target.files[0];
        const reader = new FileReader();
        
        reader.onload = function(event) {
          try {
            const messages = JSON.parse(event.target.result);
            chatHistory.innerHTML = '';
            
            messages.forEach(msg => {
              addMessage(msg.text, msg.sender);
            });
            
            showToast('ØªÙ… Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø© Ø¨Ù†Ø¬Ø§Ø­');
          } catch (error) {
            alert('Ø®Ø·Ø£ ÙÙŠ ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„Ù…Ù„Ù');
          }
        };
        
        reader.readAsText(file);
      };
      
      input.click();
    });
    
    // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª
    document.getElementById('resetSettings').addEventListener('click', () => {
      if (confirm('Ù‡Ù„ ØªØ±ÙŠØ¯ Ø­Ù‚Ø§Ù‹ Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª ÙˆØ§Ù„Ù…Ø­Ø§Ø¯Ø«Ø§ØªØŸ')) {
        localStorage.removeItem('saadai_conversations');
        conversations = [];
        updateConversationList();
        applyTheme('dark');
        updateThemeButtons();
        showToast('ØªÙ… Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª');
      }
    });
    
    // Ù…Ø³Ø­ Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ©
    document.getElementById('clearChat').addEventListener('click', clearCurrentConversation);
    
    function clearCurrentConversation() {
      if (confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ù…Ø³Ø­ ÙƒØ§Ù…Ù„ Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ©ØŸ')) {
        chatHistory.innerHTML = `
          <div class="welcome-message">
            <p>Ù…Ø±Ø­Ø¨Ø§Ù‹! Ø£Ù†Ø§ Ø³Ø¹Ø¯.AIØŒ Ø±ÙÙŠÙ‚Ùƒ Ø§Ù„Ø°ÙƒÙŠ ÙÙŠ Ø§Ù„Ø¹Ø§Ù„Ù… Ø§Ù„Ø±Ù‚Ù…ÙŠ. ÙƒÙŠÙ ÙŠÙ…ÙƒÙ†Ù†ÙŠ Ù…Ø³Ø§Ø¹Ø¯ØªÙƒ Ø§Ù„ÙŠÙˆÙ…ØŸ</p>
          </div>
        `;
        currentConversationId = 'default_' + Date.now();
        conversationTitleGenerated = false;
        showToast('ØªÙ… Ù…Ø³Ø­ Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ©');
      }
    }
    
    // Ø£Ø­Ø¯Ø§Ø« Ø§Ù„Ø¯Ø¹Ù…
    supportBtn.addEventListener('click', () => {
      supportModal.classList.add('active');
      sidebar.classList.remove('open');
    });
    
    closeSupportBtn.addEventListener('click', () => {
      supportModal.classList.remove('active');
    });
    
    copyVodafoneBtn.addEventListener('click', () => {
      const number = vodafoneNumber.textContent;
      copyToClipboard(number);
      showToast('ØªÙ… Ù†Ø³Ø® Ø±Ù‚Ù… ÙÙˆØ¯Ø§ÙÙˆÙ† ÙƒØ§Ø´: ' + number);
    });
    
    // Ø§Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ Ø£Ø­Ø¯Ø§Ø« Ø§Ù„Ø£Ø²Ø±Ø§Ø± Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù€ delegation
    chatHistory.addEventListener('click', function(e) {
      const btn = e.target.closest('.message-btn');
      if (!btn) return;
      
      const message = btn.closest('.message');
      const text = message.querySelector('p')?.textContent?.trim() || '';
      const messageId = message.dataset.messageId || Date.now().toString();
      
      if (btn.classList.contains('copy-btn')) {
        // Ù†Ø³Ø® Ø§Ù„Ù†Øµ
        copyToClipboard(text);
      } else if (btn.classList.contains('edit-btn')) {
        // ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø³Ø¤Ø§Ù„ - ÙÙ‚Ø· Ù„Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
        if (message.classList.contains('user-message')) {
          userInput.value = text;
          userInput.focus();
          
          // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ© ÙˆØ§Ù„Ø±Ø¯ Ø§Ù„ØªØ§Ù„ÙŠ Ù„Ù‡Ø§ (Ø¥Ù† ÙˆØ¬Ø¯)
          message.remove();
          const nextMessage = message.nextElementSibling;
          if (nextMessage && nextMessage.classList.contains('bot-message')) {
            nextMessage.remove();
          }
        }
      } else if (btn.classList.contains('regenerate-btn')) {
        // Ø¥Ø¹Ø§Ø¯Ø© ØªÙˆÙ„ÙŠØ¯ Ø§Ù„Ø±Ø¯ - ÙÙ‚Ø· Ù„Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„Ø¨ÙˆØª
        if (message.classList.contains('bot-message')) {
          const previousUserMessage = message.previousElementSibling;
          if (previousUserMessage && previousUserMessage.classList.contains('user-message')) {
            const userText = previousUserMessage.querySelector('p').textContent;
            message.remove();
            
            // Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰ Ù„ØªÙˆÙ„ÙŠØ¯ Ø±Ø¯ Ø¬Ø¯ÙŠØ¯
            userInput.value = userText;
            sendMessage();
          }
        }
      } else if (btn.classList.contains('like-btn')) {
        // Ø¥Ø¹Ø¬Ø§Ø¨
        btn.classList.toggle('active-like');
        btn.closest('.message-actions').querySelector('.dislike-btn').classList.remove('active-dislike');
        
        sendFeedback(messageId, 'like', text);
        btn.innerHTML = '<i class="fas fa-check"></i>';
        setTimeout(() => {
          btn.innerHTML = '<i class="fas fa-thumbs-up"></i>';
        }, 2000);
      } else if (btn.classList.contains('dislike-btn')) {
        // Ø¹Ø¯Ù… Ø¥Ø¹Ø¬Ø§Ø¨
        btn.classList.toggle('active-dislike');
        btn.closest('.message-actions').querySelector('.like-btn').classList.remove('active-like');
        
        sendFeedback(messageId, 'dislike', text);
        btn.innerHTML = '<i class="fas fa-check"></i>';
        setTimeout(() => {
          btn.innerHTML = '<i class="fas fa-thumbs-down"></i>';
        }, 2000);
      }
    });
    
    // Ù†Ø³Ø® Ø§Ù„Ù†Øµ Ø¥Ù„Ù‰ Ø§Ù„Ø­Ø§ÙØ¸Ø© Ù…Ø¹ fallback
    function copyToClipboard(text) {
      if (navigator.clipboard && navigator.clipboard.writeText) {
        navigator.clipboard.writeText(text)
          .then(() => showToast('ØªÙ… Ù†Ø³Ø® Ø§Ù„Ù†Øµ Ø¥Ù„Ù‰ Ø§Ù„Ø­Ø§ÙØ¸Ø©'))
          .catch(err => {
            console.error('Failed to copy: ', err);
            fallbackCopyText(text);
          });
      } else {
        fallbackCopyText(text);
      }
    }
    
    // Ø·Ø±ÙŠÙ‚Ø© Ø¨Ø¯ÙŠÙ„Ø© Ù„Ù„Ù†Ø³Ø®
    function fallbackCopyText(text) {
      const textArea = document.createElement('textarea');
      textArea.value = text;
      textArea.style.position = 'fixed';
      textArea.style.opacity = '0';
      document.body.appendChild(textArea);
      textArea.focus();
      textArea.select();
      
      try {
        const successful = document.execCommand('copy');
        if (successful) {
          showToast('ØªÙ… Ù†Ø³Ø® Ø§Ù„Ù†Øµ Ø¥Ù„Ù‰ Ø§Ù„Ø­Ø§ÙØ¸Ø©');
        } else {
          showToast('ÙØ´Ù„ Ù†Ø³Ø® Ø§Ù„Ù†Øµ', 3000);
        }
      } catch (err) {
        console.error('Fallback copy failed: ', err);
        showToast('ÙØ´Ù„ Ù†Ø³Ø® Ø§Ù„Ù†Øµ', 3000);
      }
      
      document.body.removeChild(textArea);
    }
    
    // Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ØªÙ‚ÙŠÙŠÙ… Ù„Ù„Ø®Ø§Ø¯Ù…
    async function sendFeedback(messageId, feedback, text) {
      try {
        const userId = window.saadUser.getId();
        await fetch('/api/feedback', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({
            messageId: messageId,
            feedback: feedback,
            text: text,
            user_id: userId
          })
        });
      } catch (error) {
        console.error('Feedback error:', error);
      }
    }
    
    // Ø¥Ø±Ø³Ø§Ù„ Ø±Ø³Ø§Ù„Ø© Ù„Ù„Ø®Ø§Ø¯Ù… Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ø¬Ø¯ÙŠØ¯
    async function sendMessage() {
      const message = userInput.value.trim();
      if (!message) return;
      
      const messageId = Date.now().toString();
      addMessage(message, 'user', true, messageId);
      saveMessage(message, 'user', messageId);
      userInput.value = '';
      
      try {
        const data = await sendToSaad(message, 'text');
        
        if (data.error && data.error === 'INVALID_USER_ID') {
          addMessage('Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø¬Ù„Ø³Ø©. ÙŠØ±Ø¬Ù‰ Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø©.', 'bot', true);
          saveMessage('Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø¬Ù„Ø³Ø©. ÙŠØ±Ø¬Ù‰ Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø©.', 'bot');
          return;
        }
        
        let botResponse = '';
        
        if (data.Ø±Ø¯) {
          botResponse = data.Ø±Ø¯;
          addMessage(botResponse, 'bot', true);
          saveMessage(botResponse, 'bot');
        } else if (data.responses) {
          const responses = [
            `[ØªÙ‚Ù†ÙŠ] ${data.responses.technical || 'Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø±Ø¯ ØªÙ‚Ù†ÙŠ'}`,
            `[Ø¹Ù…Ù„ÙŠ] ${data.responses.practical || 'Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø±Ø¯ Ø¹Ù…Ù„ÙŠ'}`,
            `[Ø¥Ø¨Ø¯Ø§Ø¹ÙŠ] ${data.responses.creative || 'Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø±Ø¯ Ø¥Ø¨Ø¯Ø§Ø¹ÙŠ'}`
          ];
          botResponse = responses.join('\n');
          responses.forEach(response => {
            addMessage(response, 'bot', true);
            saveMessage(response, 'bot');
          });
        } else {
          botResponse = 'ØªÙ„Ù‚ÙŠØª Ø±Ø¯Ù‹Ø§ ØºÙŠØ± Ù…ØªÙˆÙ‚Ø¹ Ù…Ù† Ø§Ù„Ø®Ø§Ø¯Ù…';
          addMessage(botResponse, 'bot', true);
          saveMessage(botResponse, 'bot');
        }
        
        // Ø§Ù‚ØªØ±Ø§Ø­ Ø¹Ù†ÙˆØ§Ù† Ù„Ù„Ù…Ø­Ø§Ø¯Ø«Ø© Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ù‡Ø°Ù‡ Ø£ÙˆÙ„ Ø±Ø³Ø§Ù„Ø© Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙÙŠ Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ©
        if (!conversationTitleGenerated) {
          const conv = conversations.find(c => c.id === currentConversationId);
          if (conv && conv.messages && conv.messages.filter(m => m.sender === 'user').length === 1) {
            const suggestedTitle = await suggestConversationTitle(message, botResponse);
            if (suggestedTitle) {
              conv.title = suggestedTitle;
              saveConversations();
              updateConversationList();
            }
            conversationTitleGenerated = true;
          }
        }
      } catch (error) {
        console.error('Error:', error);
        addMessage(`Ø­Ø¯Ø« Ø®Ø·Ø£: ${error.message}`, 'bot', true);
        saveMessage(`Ø­Ø¯Ø« Ø®Ø·Ø£: ${error.message}`, 'bot');
      }
    }
    
    // Ø¥Ø¶Ø§ÙØ© Ø±Ø³Ø§Ù„Ø© Ù„Ù„Ø´Ø§Ø´Ø© Ù…Ø¹ Ø£Ø²Ø±Ø§Ø±
    function addMessage(text, sender, withActions = true, messageId = null) {
      const messageDiv = document.createElement('div');
      messageDiv.classList.add('message', `${sender}-message`);
      messageDiv.setAttribute('role', 'article');
      messageDiv.setAttribute('aria-label', `${sender === 'user' ? 'Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…' : 'Ø±Ø¯ Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ'}: ${text.substring(0, 50)}...`);
      
      if (messageId) {
        messageDiv.dataset.messageId = messageId;
      }
      
      const now = new Date();
      const timeString = now.toLocaleTimeString('ar-EG', {
        hour: '2-digit',
        minute: '2-digit'
      });
      
      messageDiv.innerHTML = `
        <p>${text}</p>
        <span class="message-time">${timeString}</span>
      `;
      
      // Ø¥Ø¶Ø§ÙØ© Ø£Ø²Ø±Ø§Ø± Ø®Ø§ØµØ© Ù„ÙƒÙ„ Ù†ÙˆØ¹ Ù…Ù† Ø§Ù„Ø±Ø³Ø§Ø¦Ù„
      const actionsDiv = document.createElement('div');
      actionsDiv.className = 'message-actions';
      
      if (sender === 'user') {
        // Ø£Ø²Ø±Ø§Ø± Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…: Ù†Ø³Ø® ÙˆØªØ¹Ø¯ÙŠÙ„
        actionsDiv.innerHTML = `
          <button class="message-btn copy-btn" title="Ù†Ø³Ø® Ø§Ù„Ø±Ø³Ø§Ù„Ø©" aria-label="Ù†Ø³Ø® Ø§Ù„Ù†Øµ">
            <i class="fas fa-copy"></i>
          </button>
          <button class="message-btn edit-btn" title="ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø±Ø³Ø§Ù„Ø©" aria-label="ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø±Ø³Ø§Ù„Ø©">
            <i class="fas fa-pencil-alt"></i>
          </button>
        `;
      } else if (sender === 'bot' && withActions) {
        // Ø£Ø²Ø±Ø§Ø± Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„Ø¨ÙˆØª: Ù†Ø³Ø®ØŒ Ø¥Ø¹Ø§Ø¯Ø© ØªÙˆÙ„ÙŠØ¯ØŒ Ø¥Ø¹Ø¬Ø§Ø¨ØŒ Ø¹Ø¯Ù… Ø¥Ø¹Ø¬Ø§Ø¨
        actionsDiv.innerHTML = `
          <button class="message-btn copy-btn" title="Ù†Ø³Ø® Ø§Ù„Ø±Ø¯" aria-label="Ù†Ø³Ø® Ø§Ù„Ù†Øµ">
            <i class="fas fa-copy"></i>
          </button>
          <button class="message-btn regenerate-btn" title="Ø¥Ø¹Ø§Ø¯Ø© ØªÙˆÙ„ÙŠØ¯ Ø§Ù„Ø±Ø¯" aria-label="Ø¥Ø¹Ø§Ø¯Ø© ØªÙˆÙ„ÙŠØ¯ Ø§Ù„Ø±Ø¯">
            <i class="fas fa-redo"></i>
          </button>
          <button class="message-btn like-btn" title="Ø¥Ø¹Ø¬Ø§Ø¨ (Ù„Ù„Ù…Ø³Ø§Ø¹Ø¯Ø© ÙÙŠ Ø§Ù„ØªØ¹Ù„Ù…)" aria-label="Ø¥Ø¹Ø¬Ø§Ø¨ Ø¨Ø§Ù„Ø±Ø¯">
            <i class="fas fa-thumbs-up"></i>
          </button>
          <button class="message-btn dislike-btn" title="Ø¹Ø¯Ù… Ø¥Ø¹Ø¬Ø§Ø¨ (Ù„Ù„Ù…Ø³Ø§Ø¹Ø¯Ø© ÙÙŠ Ø§Ù„ØªØ¹Ù„Ù…)" aria-label="Ø¹Ø¯Ù… Ø¥Ø¹Ø¬Ø§Ø¨ Ø¨Ø§Ù„Ø±Ø¯">
            <i class="fas fa-thumbs-down"></i>
          </button>
        `;
      }
      
      if (actionsDiv.innerHTML.trim() !== '') {
        messageDiv.appendChild(actionsDiv);
      }
      
      chatHistory.appendChild(messageDiv);
      chatHistory.scrollTop = chatHistory.scrollHeight;
      
      // ØªØ£Ø«ÙŠØ± Ø§Ù„Ø¸Ù‡ÙˆØ±
      messageDiv.style.transform = 'scale(0.9)';
      messageDiv.style.opacity = '0';
      setTimeout(() => {
        messageDiv.style.transform = 'scale(1)';
        messageDiv.style.opacity = '1';
      }, 10);
    }
    
    // Ø¹Ø±Ø¶ Ù…Ø¤Ø´Ø± Ø§Ù„ØªØ­Ù…ÙŠÙ„
    function showLoading() {
      const loadingId = 'loading-' + Date.now();
      const loadingDiv = document.createElement('div');
      loadingDiv.id = loadingId;
      loadingDiv.classList.add('message', 'bot-message');
      loadingDiv.innerHTML = `
        <div class="loading-dots">
          <span></span>
          <span></span>
          <span></span>
        </div>
      `;
      chatHistory.appendChild(loadingDiv);
      chatHistory.scrollTop = chatHistory.scrollHeight;
      return loadingId;
    }
    
    // Ø¥Ø²Ø§Ù„Ø© Ù…Ø¤Ø´Ø± Ø§Ù„ØªØ­Ù…ÙŠÙ„
    function removeLoading(id) {
      const loadingElement = document.getElementById(id);
      if (loadingElement) {
        loadingElement.style.opacity = '0';
        setTimeout(() => {
          if (loadingElement.parentNode) {
            loadingElement.parentNode.removeChild(loadingElement);
          }
        }, 300);
      }
    }
    
    // ØªÙ‡ÙŠØ¦Ø© Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø§Øª
    updateConversationList();
  });
  </script>
</body>
</html>
